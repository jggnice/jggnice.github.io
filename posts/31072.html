<!DOCTYPE html><html lang="ch"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="Li ShiWang"><link rel="icon" href="/hexo.png"><title>Li ShiWang</title><meta name="description" content=""><link rel="alternate" type="application/rss+xml" title="Li ShiWang" href="/atom.xml"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/highlight.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><meta name="generator" content="Hexo 5.4.0"></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Li ShiWang</a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/archives">Archive</a></li><li><a target="_blank" rel="noopener" href="https://github.com/twoyao/beautiful-hexo">Github</a></li><li><a href="/about/">About</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a href="/"><img src="/hexo.png" class="avatar-img"></a></div></div></div></nav><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>git备忘录</h1><p class="post-meta">Posted on Sep 3 2016 · <a href="/tags/%E3%80%8Agit%E3%80%8B/" class="tag post-meta">《git》</a></p></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><ul>
<li>TOC<br>{:toc}</li>
</ul>
<h2 id="git-常用命令速查表"><a href="#git-常用命令速查表" class="headerlink" title="git 常用命令速查表"></a>git 常用命令速查表</h2><p><img src="/images/blog/2016/02-14/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.jpg" alt="git常用命令速查表"></p>
<p><a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2">Pro git book</a> 里面的内容应该是足够日常使用了，也是查阅的好地方。本文内容在其中应该都能够找到。</p>
<h2 id="git-常见场景下的用法"><a href="#git-常见场景下的用法" class="headerlink" title="git 常见场景下的用法"></a>git 常见场景下的用法</h2><h3 id="撤销修改"><a href="#撤销修改" class="headerlink" title="撤销修改"></a>撤销修改</h3><ul>
<li><p>放弃刚刚对一个文件的改动<br>刚刚修改了一个文件，但是现在发现还是修改之前的好，打算放弃刚才对这个文件的修改。<br>在这种情况下，其实只要执行一下 <code>git status</code>就会有所提示，比方我们刚刚修改了一个叫做index.html的文件，在terminal中执行<code>git status</code>：<br> <img src="/images/blog/2016/02-14/git-status.png" alt="git status"><br>根据提示，使用<code>git add index.html</code>则是将此次修改提交到了暂存区，使用<code>git checkout -- index.html</code>则是放弃这次的修改，将文件还原到此次修改前的状态。</p>
</li>
<li><p>提交完了才发现漏掉了几个文件没有添加，或者提交信息写错了。<br>此时，可以运行带有 <code>--amend</code> 选项的提交命令尝试重新提交.这个命令会将暂存区中的文件提交。 如果自上次提交以来你还未做任何修改（例如，在上次提交后马上执行了此命令），那么快照会保持不变，而你所修改的只是提交信息。比如，在<code>git commit -m "modified inndex.html"</code>后， 你发现index写错了或者还有文件没有提交，如果还有文件additional-files需要提交，那么输入<code>git add additional-files</code>.如果没有任何文件需要修改提交，只是修改提交信息，那么直接输入<code>git commit --amend</code>，文本编辑器启动后，可以看到之前的提交信息。 编辑后保存会覆盖原来的提交信息。<br>最终你只会有一个提交 - 第二次提交将代替第一次提交的结果。</p>
</li>
</ul>
<h3 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h3><p>版本回退大致分为2种情况:<br>1：一切操作都还停留在本地仓库，<code>add</code> –&gt; <code>commit</code>后并未 <code>push</code> 推送到远端；<br>2：已经执行 <code>push</code> 操作将修改推送到远端。</p>
<h4 id="尚未push"><a href="#尚未push" class="headerlink" title="尚未push"></a>尚未<code>push</code></h4><p> 这种情况发生在你的本地代码仓库，可能在执行 add –&gt; commit 以后发现代码有点问题，准备取消此次commit， 这时用到 <code>reset</code> 命令<br><code>git reset -- soft | -- mixed | -- hard</code></p>
<ul>
<li><p><code> -- mixed</code><br><code>git reset</code> 默认选项， 会保留源码， 只是将 git commit 和 index 信息回退到了某个版本. <code>git reset --mixed</code>  等价于  <code>git reset</code></p>
</li>
<li><p><code> -- soft</code><br>保留源码，只回退到 commit 信息到某个版本.不涉及 index 的回退，如果还需要提交，直接commit即可.</p>
</li>
<li><p><code> -- hard</code><br>源码也会回退到某个版本，commit 和 index 都回退到某个版本.(注意，这种方式是改变本地代码仓库源码)</p>
</li>
</ul>
<p>比方说我们想回到上一个版本。</p>
<p>首先，Git必须知道当前版本是哪个版本，在Git中，用HEAD表示当前版本，也就是最新的提交版本，上一个版本就是<code>HEAD^</code>，上上一个版本就是<code>HEAD^^</code>，当然往上100个版本写100个<code>^</code>也不太容易，所以写成<code>HEAD~100</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD^  //  回到上一个版本</span><br></pre></td></tr></table></figure>

<p>当然有人在 push 代码以后，也使用 reset –hard &lt;commit…&gt; 回退代码到某个版本之前，但是这样会有一个问题，你线上的代码没有变，线上commit，index都没有变，当你把本地代码修改完提交的时候你会发现全是冲突…..</p>
<p> 所以，这种情况你要使用下面的方式:</p>
<h4 id="已经push"><a href="#已经push" class="headerlink" title="已经push"></a>已经<code>push</code></h4><p>对于已经把代码push到线上仓库，你想回退本地代码的同时也回退线上代码，回滚到某个指定的版本，线上，线下代码保持一致.这时要用到下面的revert命令</p>
<p>执行 revert 命令时要求工作树必须是干净的，git revert 用一个新提交来消除一个历史提交所做的任何修改.</p>
<p>revert 之后你的本地代码会回滚到指定的历史版本，这时你再 git push 即可以把线上的代码更新.(这里不会像reset造成冲突的问题)</p>
<p>revert 使用，需要先找到你想回滚版本唯一的 commit 标识代码，可以用 git log 查看.<br><code>git revert c011eb3c20ba6fb38cc94fe5a8dda366a3990c61</code><br>通常，前几位即可 <code>git revert c011eb3</code><br>git revert 是用一次新的commit来回滚之前的commit，git reset是直接删除指定的commit</p>
<p>看似达到的效果是一样的，其实完全不同.</p>
<ol>
<li><p>上面我们说的如果你已经 push 到线上代码库， reset 删除指定 commit 以后，你 git push 可能导致一大堆冲突.但是 revert 并不会.</p>
</li>
<li><p>如果在日后现有分支和历史分支需要合并的时候，reset 恢复部分的代码依然会出现在历史分支里.但是revert 方向提交的commit 并不会出现在历史分支里.</p>
</li>
<li><p>reset 是在正常的commit历史中，删除了指定的commit，这时 HEAD 是向后移动了，而 revert 是在正常的commit历史中再commit一次，只不过是反向提交，他的 HEAD 是一直向前的.</p>
</li>
</ol>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><ul>
<li><a target="_blank" rel="noopener" href="https://yijiebuyi.com/blog/8f985d539566d0bf3b804df6be4e0c90.html">git reset revert 回退回滚取消提交返回上一版本</a></li>
</ul>
</article><ul class="pager blog-pager"><li class="previous"><a href="/posts/17347.html" data-toggle="tooltip" data-placement="top" title="打造一个简洁高效的Windows环境">← Previous Post</a></li></ul><div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div><script src="//img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"> </script><script>var cloudTieConfig = {
  url: document.location.href, 
  sourceId: "",
  productKey: "64d7f0abf9224be3bfdcc6cfb9b83fcf",
  target: "cloud-tie-wrapper"
};</script></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a target="_blank" rel="noopener" href="http://weibo.com/bisyao?is_all=1" title="Weibo"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-weibo"></i></span></a></li><li><a target="_blank" rel="noopener" href="https://github.com/twoyao" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li><li><a href="/atom.xml" title="RSS"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-rss"></i></span></a></li><li><a target="_blank" rel="noopener" href="https://twitter.com/twoyao_" title="Twitter"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-twitter"></i></span></a></li><li><a href="mailto:bisyao@gmail.com" title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-envelope"></i></span></a></li></ul><p class="copyright text-muted">© Li ShiWang • 2021 • <a href="mailto:undefined"></a>
</p><p class="theme-by text-muted">Theme by
<a target="_blank" rel="noopener" href="https://github.com/twoyao/beautiful-hexo">beautiful-hexo</a></p></div></div></div></footer><script src="//cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script><script src="//cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/js/main.js"></script><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>